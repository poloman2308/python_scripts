from openpyxl.chart import Reference
from openpyxl.styles import Alignment, Side
from openpyxl.workbook import Workbook

from .utils import (
    calculate_values, column_sizing, create_bar_chart, ensure_tabs_exist,
    format_cells, hide_columns, input_dates,
    input_values, standart_bold_font,
    standart_pattern_fill, thin_border,
)

cell_values = {
    "F1": "Install Base (IB)",
    "G1": "HW LDoS",
    "AB1": "All NPL HW LDoS (no support)",
    "AC1": "Corporate HW LDoS (no support)",
    "AD1": "Retail HW LDoS (mo support)",
    "AE1": "Wireless HW LDoS (no support)",
    "AF1": "Wireless Excluded APs HW LDoS",
    "B2": "All NPL reported Chassis",
    "B3": "NPL Chassis excluding APs",
    "B4": "Not Available (No Owner Provided)",
    "B5": "Business Partner",
    "B6": "Core WAN & Telecom",
    "B7": "Corporate",
    "B8": "Electronic Trading Services",
    "B9": "EUS Voice",
    "B10": "Internet",
    "B11": "Application Traffic Routing",
    "B12": "Retail Branch",
    "B13": "Switch and Routing",
    "B14": "Shared Network Products",
    "B15": "Swiss Owned Devices",
    "B16": "Unknown",
    "B17": "Wireless",
    "B18": "Wireless EXcluding APs",
    "B20": "Hardware Non-compliance - Chassis",
    "B22": "All NPL reported Chassis",
    "B23": "HW LDOS (no support)",
    "B24": "HW LDOS (no support)",
    "B25": "NPL Chassis excluding APs",
    "B26": "HW LDOS (no support)",
    "B27": "HW LDOS (no support)",
    "B28": "Not Available (No Owner Provided)",
    "B29": "HW LDOS (no support)",
    "B30": "HW LDOS (no support)",
    "B31": "Business Partner",
    "B32": "HW LDOS (no support)",
    "B33": "HW LDOS (no support)",
    "B34": "Core WAN & Telecom",
    "B35": "HW LDOS (no support)",
    "B36": "HW LDOS (no support)",
    "B37": "Corporate",
    "B38": "HW LDOS (no support)",
    "B39": "HW LDOS (no support)",
    "B40": "Electronic Trading Services",
    "B41": "HW LDOS (no support)",
    "B43": "EUS Voice",
    "B44": "HW LDOS (no support)",
    "B45": "HW LDOS (no support)",
    "B46": "Internet",
    "B47": "HW LDOS (no support)",
    "B48": "HW LDOS (no support)",
    "B49": "Application Traffic Routing",
    "B50": "HW LDOS (no support)",
    "B51": "HW LDOS (no support)",
    "B52": "Retail Branch",
    "B53": "HW LDOS (no support)",
    "B54": "HW LDOS (no support)",
    "B55": "Switch and Routing",
    "B56": "HW LDOS (no support)",
    "B57": "HW LDOS (no support)",
    "B58": "Shared Network Products",
    "B59": "HW LDOS (no support)",
    "B60": "HW LDOS (no support)",
    "B61": "Swiss Owned Devices",
    "B62": "HW LDOS (no support)",
    "B63": "HW LDOS (no support)",
    "B64": "Unknown",
    "B65": "HW LDOS (no support)",
    "B66": "HW LDOS (no support)",
    "B67": "Wireless",
    "B68": "HW LDOS (no support)",
    "B69": "HW LDOS (no support)",
    "B70": "Wireless EXcluding APs",
    "B71": "HW LDOS (no support)",
    "B72": "HW LDOS (no support)",
    "C21": "Criteria 1",
    "C22": "*Customer File*",
    "C25": "*Customer File*",
    "C28": "*Customer File*",
    "C31": "*Customer File*",
    "C34": "*Customer File*",
    "C37": "*Customer File*",
    "C40": "*Customer File*",
    "C43": "*Customer File*",
    "C46": "*Customer File*",
    "C49": "*Customer File*",
    "C52": "*Customer File*",
    "C55": "*Customer File*",
    "C58": "*Customer File*",
    "C61": "*Customer File*",
    "C64": "*Customer File*",
    "C67": "*Customer File*",
    "C70": "*Customer File*",
    "D21": "Criteria 2",
    "D22": "<>*Not NPL*",
    "D25": "<>*Not NPL*",
    "D28": "Not Available",
    "D31": "Business Partner",
    "D34": "Core WAN & Telecom",
    "D37": "Corporate",
    "D40": "Electronic Trading Services",
    "D43": "EUS Voice",
    "D46": "Internet",
    "D49": "Application Traffic Routing",
    "D52": "Retail Branch",
    "D55": "Switch and Routing",
    "D58": "Shared Network Products",
    "D61": "Swiss Owned Devices",
    "D64": "Unknown",
    "D67": "Wireless",
    "D70": "Wireless",
    "E21": "Criteria 3",
    "E25": "<>WAP",
    "E70": "<>WAP"
}
cell_formulas = {
    "F22:Y22": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D22), "#,##0")',
    "F25:Y25": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D25,Report!$J:$J, $E$25), "#,##0")',
    "F28:Y28": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28), "#,##0")',
    "F31:Y31": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31), "#,##0")',
    "F34:Y34": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34), "#,##0")',
    "F37:Y37": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37), "#,##0")',
    "F40:Y40": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40), "#,##0")',
    "F43:Y43": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43), "#,##0")',
    "F46:Y46": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46), "#,##0")',
    "F49:Y49": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49), "#,##0")',
    "F52:Y52": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52), "#,##0")',
    "F55:Y55": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55), "#,##0")',
    "F58:Y58": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58), "#,##0")',
    "F61:Y61": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61), "#,##0")',
    "F64:Y64": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64), "#,##0")',
    "F67:Y67": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67), "#,##0")',
    "F70:Y70": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70), "#,##0")'
}
calculation_mapping_npl_hw_eol_timeline = {
    "F23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&F$21), "#,##0")',
    "G23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&G$21), "#,##0")',
    "H23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&H$21), "#,##0")',
    "I23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&I$21), "#,##0")',
    "J23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&J$21), "#,##0")',
    "K23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&K$21), "#,##0")',
    "L23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&L$21), "#,##0")',
    "M23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&M$21), "#,##0")',
    "N23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&N$21), "#,##0")',
    "O23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&O$21), "#,##0")',
    "P23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&R$21), "#,##0")',
    "S23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&S$21), "#,##0")',
    "T23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&T$21), "#,##0")',
    "U23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&U$21), "#,##0")',
    "V23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&V$21), "#,##0")',
    "W23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&W$21), "#,##0")',
    "X23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y23": '=TEXT(COUNTIFS(Report!$B:$B,$C22,Report!$C:$C,$D$22,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F24": "=F23/F22",
    "G24": "=G23/G22",
    "H24": "=H23/H22",
    "I24": "=I23/I22",
    "J24": "=J23/J22",
    "K24": "=K23/K22",
    "L24": "=L23/L22",
    "M24": "=M23/M22",
    "N24": "=N23/N22",
    "O24": "=O23/O22",
    "P24": "=P23/P22",
    "Q24": "=Q23/Q22",
    "R24": "=R23/R22",
    "S24": "=S23/S22",
    "T24": "=T23/T22",
    "U24": "=U23/U22",
    "V24": "=V23/V22",
    "W24": "=W23/W22",
    "X24": "=X23/X22",
    "Y24": "=Y23/Y22",
    "F26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&F$21), "#,##0")',
    "G26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&G$21), "#,##0")',
    "H26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&H$21), "#,##0")',
    "I26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&I$21), "#,##0")',
    "J26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&J$21), "#,##0")',
    "K26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&K$21), "#,##0")',
    "L26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&L$21), "#,##0")',
    "M26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&M$21), "#,##0")',
    "N26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&N$21), "#,##0")',
    "O26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&O$21), "#,##0")',
    "P26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&R$21), "#,##0")',
    "S26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&S$21), "#,##0")',
    "T26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&T$21), "#,##0")',
    "U26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&U$21), "#,##0")',
    "V26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&V$21), "#,##0")',
    "W26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&W$21), "#,##0")',
    "X26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y26": '=TEXT(COUNTIFS(Report!$B:$B,$C25,Report!$C:$C,$D$25,Report!$J:$J,$E$25,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F27": "=F26/F25",
    "G27": "=G26/G25",
    "H27": "=H26/H25",
    "I27": "=I26/I25",
    "J27": "=J26/J25",
    "K27": "=K26/K25",
    "L27": "=L26/L25",
    "M27": "=M26/M25",
    "N27": "=N26/N25",
    "O27": "=O26/O25",
    "P27": "=P26/P25",
    "Q27": "=Q26/Q25",
    "R27": "=R26/R25",
    "S27": "=S26/S25",
    "T27": "=T26/T25",
    "U27": "=U26/U25",
    "V27": "=V26/V25",
    "W27": "=W26/W25",
    "X27": "=X26/X25",
    "Y27": "=Y26/Y25",
    "F29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&F$21), "#,##0")',
    "G29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&G$21), "#,##0")',
    "H29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&H$21), "#,##0")',
    "I29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&I$21), "#,##0")',
    "J29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&J$21), "#,##0")',
    "K29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&K$21), "#,##0")',
    "L29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&L$21), "#,##0")',
    "M29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&M$21), "#,##0")',
    "N29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&N$21), "#,##0")',
    "O29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&O$21), "#,##0")',
    "P29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&R$21), "#,##0")',
    "S29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&S$21), "#,##0")',
    "T29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&T$21), "#,##0")',
    "U29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&U$21), "#,##0")',
    "V29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&V$21), "#,##0")',
    "W29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&W$21), "#,##0")',
    "X29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y29": '=TEXT(COUNTIFS(Report!$B:$B,$C28,Report!$C:$C,$D28,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F30": "=F29/F28",
    "G30": "=G29/G28",
    "H30": "=H29/H28",
    "I30": "=I29/I28",
    "J30": "=J29/J28",
    "K30": "=K29/K28",
    "L30": "=L29/L28",
    "M30": "=M29/M28",
    "N30": "=N29/N28",
    "O30": "=O29/O28",
    "P30": "=P29/P28",
    "Q30": "=Q29/Q28",
    "R30": "=R29/R28",
    "S30": "=S29/S28",
    "T30": "=T29/T28",
    "U30": "=U29/U28",
    "V30": "=V29/V28",
    "W30": "=W29/W28",
    "X30": "=X29/X28",
    "Y30": "=Y29/Y28",
    "F32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&F$21), "#,##0")',
    "G32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&G$21), "#,##0")',
    "H32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&H$21), "#,##0")',
    "I32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&I$21), "#,##0")',
    "J32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&J$21), "#,##0")',
    "K32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&K$21), "#,##0")',
    "L32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&L$21), "#,##0")',
    "M32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&M$21), "#,##0")',
    "N32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&N$21), "#,##0")',
    "O32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&O$21), "#,##0")',
    "P32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&R$21), "#,##0")',
    "S32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&S$21), "#,##0")',
    "T32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&T$21), "#,##0")',
    "U32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&U$21), "#,##0")',
    "V32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&V$21), "#,##0")',
    "W32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&W$21), "#,##0")',
    "X32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y32": '=TEXT(COUNTIFS(Report!$B:$B,$C31,Report!$C:$C,$D31,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F33": "=F32/F31",
    "G33": "=G32/G31",
    "H33": "=H32/H31",
    "I33": "=I32/I31",
    "J33": "=J32/J31",
    "K33": "=K32/K31",
    "L33": "=L32/L31",
    "M33": "=M32/M31",
    "N33": "=N32/N31",
    "O33": "=O32/O31",
    "P33": "=P32/P31",
    "Q33": "=Q32/Q31",
    "R33": "=R32/R31",
    "S33": "=S32/S31",
    "T33": "=T32/T31",
    "U33": "=U32/U31",
    "V33": "=V32/V31",
    "W33": "=W32/W31",
    "X33": "=X32/X31",
    "Y33": "=Y32/Y31",
    "F35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&F$21), "#,##0")',
    "G35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&G$21), "#,##0")',
    "H35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&H$21), "#,##0")',
    "I35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&I$21), "#,##0")',
    "J35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&J$21), "#,##0")',
    "K35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&K$21), "#,##0")',
    "L35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&L$21), "#,##0")',
    "M35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&M$21), "#,##0")',
    "N35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&N$21), "#,##0")',
    "O35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&O$21), "#,##0")',
    "P35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&R$21), "#,##0")',
    "S35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&S$21), "#,##0")',
    "T35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&T$21), "#,##0")',
    "U35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&U$21), "#,##0")',
    "V35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&V$21), "#,##0")',
    "W35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&W$21), "#,##0")',
    "X35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y35": '=TEXT(COUNTIFS(Report!$B:$B,$C34,Report!$C:$C,$D34,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F36": "=F35/F34",
    "G36": "=G35/G34",
    "H36": "=H35/H34",
    "I36": "=I35/I34",
    "J36": "=J35/J34",
    "K36": "=K35/K34",
    "L36": "=L35/L34",
    "M36": "=M35/M34",
    "N36": "=N35/N34",
    "O36": "=O35/O34",
    "P36": "=O35/O34",
    "Q36": "=O35/O34",
    "R36": "=O35/O34",
    "S36": "=O35/O34",
    "T36": "=O35/O34",
    "U36": "=O35/O34",
    "V36": "=O35/O34",
    "W36": "=O35/O34",
    "X36": "=O35/O34",
    "Y36": "=O35/O34",
    "F38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&F$21), "#,##0")',
    "G38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&G$21), "#,##0")',
    "H38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&H$21), "#,##0")',
    "I38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&I$21), "#,##0")',
    "J38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&J$21), "#,##0")',
    "K38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&K$21), "#,##0")',
    "L38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&L$21), "#,##0")',
    "M38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&M$21), "#,##0")',
    "N38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&N$21), "#,##0")',
    "O38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&O$21), "#,##0")',
    "P38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&R$21), "#,##0")',
    "S38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&S$21), "#,##0")',
    "T38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&T$21), "#,##0")',
    "U38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&U$21), "#,##0")',
    "V38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&V$21), "#,##0")',
    "W38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&W$21), "#,##0")',
    "X38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y38": '=TEXT(COUNTIFS(Report!$B:$B,$C37,Report!$C:$C,$D37,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F39": "=F38/F37",
    "G39": "=G38/G37",
    "H39": "=H38/H37",
    "I39": "=I38/I37",
    "J39": "=J38/J37",
    "K39": "=K38/K37",
    "L39": "=L38/L37",
    "M39": "=M38/M37",
    "N39": "=N38/N37",
    "O39": "=O38/O37",
    "P39": "=P38/P37",
    "Q39": "=Q38/Q37",
    "R39": "=R38/R37",
    "S39": "=S38/S37",
    "T39": "=T38/T37",
    "U39": "=U38/U37",
    "V39": "=V38/V37",
    "W39": "=W38/W37",
    "X39": "=X38/X37",
    "Y39": "=Y38/Y37",
    "F41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&F$21), "#,##0")',
    "G41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&G$21), "#,##0")',
    "H41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&H$21), "#,##0")',
    "I41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&I$21), "#,##0")',
    "J41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&J$21), "#,##0")',
    "K41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&K$21), "#,##0")',
    "L41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&L$21), "#,##0")',
    "M41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&M$21), "#,##0")',
    "N41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&N$21), "#,##0")',
    "O41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&O$21), "#,##0")',
    "P41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&R$21), "#,##0")',
    "S41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&S$21), "#,##0")',
    "T41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&T$21), "#,##0")',
    "U41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&U$21), "#,##0")',
    "V41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&V$21), "#,##0")',
    "W41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&W$21), "#,##0")',
    "X41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y41": '=TEXT(COUNTIFS(Report!$B:$B,$C40,Report!$C:$C,$D40,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F42": "=F41/F40",
    "G42": "=G41/G40",
    "H42": "=H41/H40",
    "I42": "=I41/I40",
    "J42": "=J41/J40",
    "K42": "=K41/K40",
    "L42": "=L41/L40",
    "M42": "=M41/M40",
    "N42": "=N41/N40",
    "O42": "=O41/O40",
    "P42": "=P41/P40",
    "Q42": "=Q41/Q40",
    "R42": "=R41/R40",
    "S42": "=S41/S40",
    "T42": "=T41/T40",
    "U42": "=U41/U40",
    "V42": "=V41/V40",
    "W42": "=W41/W40",
    "X42": "=X41/X40",
    "Y42": "=Y41/Y40",
    "F44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&F$21), "#,##0")',
    "G44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&G$21), "#,##0")',
    "H44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&H$21), "#,##0")',
    "I44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&I$21), "#,##0")',
    "J44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&J$21), "#,##0")',
    "K44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&K$21), "#,##0")',
    "L44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&L$21), "#,##0")',
    "M44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&M$21), "#,##0")',
    "N44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&N$21), "#,##0")',
    "O44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&O$21), "#,##0")',
    "P44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&R$21), "#,##0")',
    "S44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&S$21), "#,##0")',
    "T44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&T$21), "#,##0")',
    "U44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&U$21), "#,##0")',
    "V44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&V$21), "#,##0")',
    "W44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&W$21), "#,##0")',
    "X44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y44": '=TEXT(COUNTIFS(Report!$B:$B,$C43,Report!$C:$C,$D43,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F45": "=F44/F43",
    "G45": "=G44/G43",
    "H45": "=H44/H43",
    "I45": "=I44/I43",
    "J45": "=J44/J43",
    "K45": "=K44/K43",
    "L45": "=L44/L43",
    "M45": "=M44/M43",
    "N45": "=N44/N43",
    "O45": "=O44/O43",
    "P45": "=P44/P43",
    "Q45": "=Q44/Q43",
    "R45": "=R44/R43",
    "S45": "=S44/S43",
    "T45": "=T44/T43",
    "U45": "=U44/U43",
    "V45": "=V44/V43",
    "W45": "=W44/W43",
    "X45": "=X44/X43",
    "Y45": "=Y44/Y43",
    "F47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&F$21), "#,##0")',
    "G47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&G$21), "#,##0")',
    "H47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&H$21), "#,##0")',
    "I47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&I$21), "#,##0")',
    "J47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&J$21), "#,##0")',
    "K47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&K$21), "#,##0")',
    "L47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&L$21), "#,##0")',
    "M47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&M$21), "#,##0")',
    "N47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&N$21), "#,##0")',
    "O47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&O$21), "#,##0")',
    "P47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&R$21), "#,##0")',
    "S47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&S$21), "#,##0")',
    "T47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&T$21), "#,##0")',
    "U47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&U$21), "#,##0")',
    "V47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&V$21), "#,##0")',
    "W47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&W$21), "#,##0")',
    "X47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y47": '=TEXT(COUNTIFS(Report!$B:$B,$C46,Report!$C:$C,$D46,Report!$P:$P,"<="&F$21), "#,##0")',
    "F48": "=F47/F46",
    "G48": "=G47/G46",
    "H48": "=H47/H46",
    "I48": "=I47/I46",
    "J48": "=J47/J46",
    "K48": "=K47/K46",
    "L48": "=L47/L46",
    "M48": "=M47/M46",
    "N48": "=N47/N46",
    "O48": "=O47/O46",
    "P48": "=P47/P46",
    "Q48": "=Q47/Q46",
    "R48": "=R47/R46",
    "S48": "=S47/S46",
    "T48": "=T47/T46",
    "U48": "=U47/U46",
    "V48": "=V47/V46",
    "W48": "=W47/W46",
    "X48": "=X47/X46",
    "Y48": "=Y47/Y46",
    "F50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&F$21), "#,##0")',
    "G50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&G$21), "#,##0")',
    "H50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&H$21), "#,##0")',
    "I50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&I$21), "#,##0")',
    "J50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&J$21), "#,##0")',
    "K50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&K$21), "#,##0")',
    "L50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&L$21), "#,##0")',
    "M50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&M$21), "#,##0")',
    "N50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&N$21), "#,##0")',
    "O50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&O$21), "#,##0")',
    "P50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&R$21), "#,##0")',
    "S50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&S$21), "#,##0")',
    "T50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&T$21), "#,##0")',
    "U50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&U$21), "#,##0")',
    "V50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&V$21), "#,##0")',
    "W50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&W$21), "#,##0")',
    "X50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y50": '=TEXT(COUNTIFS(Report!$B:$B,$C49,Report!$C:$C,$D49,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F51": "=F50/F49",
    "G51": "=G50/G49",
    "H51": "=H50/H49",
    "I51": "=I50/I49",
    "J51": "=J50/J49",
    "K51": "=K50/K49",
    "L51": "=L50/L49",
    "M51": "=M50/M49",
    "N51": "=N50/N49",
    "O51": "=O50/O49",
    "P51": "=P50/P49",
    "Q51": "=Q50/Q49",
    "R51": "=R50/R49",
    "S51": "=S50/S49",
    "T51": "=T50/T49",
    "U51": "=U50/U49",
    "V51": "=V50/V49",
    "W51": "=W50/W49",
    "X51": "=X50/X49",
    "Y51": "=Y50/Y49",
    "F53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&F$21), "#,##0")',
    "G53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&G$21), "#,##0")',
    "H53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&H$21), "#,##0")',
    "I53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&I$21), "#,##0")',
    "J53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&J$21), "#,##0")',
    "K53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&K$21), "#,##0")',
    "L53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&L$21), "#,##0")',
    "M53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&M$21), "#,##0")',
    "N53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&N$21), "#,##0")',
    "O53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&O$21), "#,##0")',
    "P53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&R$21), "#,##0")',
    "S53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&S$21), "#,##0")',
    "T53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&T$21), "#,##0")',
    "U53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&U$21), "#,##0")',
    "V53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&V$21), "#,##0")',
    "W53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&W$21), "#,##0")',
    "X53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y53": '=TEXT(COUNTIFS(Report!$B:$B,$C52,Report!$C:$C,$D52,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F54": "=F53/F52",
    "G54": "=G53/G52",
    "H54": "=H53/H52",
    "I54": "=I53/I52",
    "J54": "=J53/J52",
    "K54": "=K53/K52",
    "L54": "=L53/L52",
    "M54": "=M53/M52",
    "N54": "=N53/N52",
    "O54": "=O53/O52",
    "P54": "=P53/P52",
    "Q54": "=Q53/Q52",
    "R54": "=R53/R52",
    "S54": "=S53/S52",
    "T54": "=T53/T52",
    "U54": "=U53/U52",
    "V54": "=V53/V52",
    "W54": "=W53/W52",
    "X54": "=X53/X52",
    "Y54": "=Y53/Y52",
    "F56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&F$21), "#,##0")',
    "G56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&G$21), "#,##0")',
    "H56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&H$21), "#,##0")',
    "I56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&I$21), "#,##0")',
    "J56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&J$21), "#,##0")',
    "K56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&K$21), "#,##0")',
    "L56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&L$21), "#,##0")',
    "M56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&M$21), "#,##0")',
    "N56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&N$21), "#,##0")',
    "O56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&O$21), "#,##0")',
    "P56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&R$21), "#,##0")',
    "S56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&S$21), "#,##0")',
    "T56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&T$21), "#,##0")',
    "U56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&U$21), "#,##0")',
    "V56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&V$21), "#,##0")',
    "W56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&W$21), "#,##0")',
    "X56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y56": '=TEXT(COUNTIFS(Report!$B:$B,$C55,Report!$C:$C,$D55,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F57": "=F56/F55",
    "G57": "=G56/G55",
    "H57": "=H56/H55",
    "I57": "=I56/I55",
    "J57": "=J56/J55",
    "K57": "=K56/K55",
    "L57": "=L56/L55",
    "M57": "=M56/M55",
    "N57": "=N56/N55",
    "O57": "=O56/O55",
    "P57": "=P56/P55",
    "Q57": "=Q56/Q55",
    "R57": "=R56/R55",
    "S57": "=S56/S55",
    "T57": "=T56/T55",
    "U57": "=U56/U55",
    "V57": "=V56/V55",
    "W57": "=W56/W55",
    "X57": "=X56/X55",
    "Y57": "=Y56/Y55",
    "F59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&F$21), "#,##0")',
    "G59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&G$21), "#,##0")',
    "H59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&H$21), "#,##0")',
    "I59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&I$21), "#,##0")',
    "J59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&J$21), "#,##0")',
    "K59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&K$21), "#,##0")',
    "L59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&L$21), "#,##0")',
    "M59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&M$21), "#,##0")',
    "N59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&N$21), "#,##0")',
    "O59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&O$21), "#,##0")',
    "P59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&R$21), "#,##0")',
    "S59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&S$21), "#,##0")',
    "T59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&T$21), "#,##0")',
    "U59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&U$21), "#,##0")',
    "V59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&V$21), "#,##0")',
    "W59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&W$21), "#,##0")',
    "X59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y59": '=TEXT(COUNTIFS(Report!$B:$B,$C58,Report!$C:$C,$D58,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F60": "=F59/F58",
    "G60": "=G59/G58",
    "H60": "=H59/H58",
    "I60": "=I59/I58",
    "J60": "=J59/J58",
    "K60": "=K59/K58",
    "L60": "=L59/L58",
    "M60": "=M59/M58",
    "N60": "=N59/N58",
    "O60": "=O59/O58",
    "P60": "=P59/P58",
    "Q60": "=Q59/Q58",
    "R60": "=R59/R58",
    "S60": "=S59/S58",
    "T60": "=T59/T58",
    "U60": "=U59/U58",
    "V60": "=V59/V58",
    "W60": "=W59/W58",
    "X60": "=X59/X58",
    "Y60": "=Y59/Y58",
    "F62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&F$21), "#,##0")',
    "G62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&G$21), "#,##0")',
    "H62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&H$21), "#,##0")',
    "I62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&I$21), "#,##0")',
    "J62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&J$21), "#,##0")',
    "K62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&K$21), "#,##0")',
    "L62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&L$21), "#,##0")',
    "M62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&M$21), "#,##0")',
    "N62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&N$21), "#,##0")',
    "O62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&O$21), "#,##0")',
    "P62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&R$21), "#,##0")',
    "S62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&S$21), "#,##0")',
    "T62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&T$21), "#,##0")',
    "U62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&U$21), "#,##0")',
    "V62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&V$21), "#,##0")',
    "W62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&W$21), "#,##0")',
    "X62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y62": '=TEXT(COUNTIFS(Report!$B:$B,$C61,Report!$C:$C,$D61,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F63": "=F62/F61",
    "G63": "=G62/G61",
    "H63": "=H62/H61",
    "I63": "=I62/I61",
    "J63": "=J62/J61",
    "K63": "=K62/K61",
    "L63": "=L62/L61",
    "M63": "=M62/M61",
    "N63": "=N62/N61",
    "O63": "=O62/O61",
    "P63": "=P62/P61",
    "Q63": "=Q62/Q61",
    "R63": "=R62/R61",
    "S63": "=S62/S61",
    "T63": "=T62/T61",
    "U63": "=U62/U61",
    "V63": "=V62/V61",
    "W63": "=W62/W61",
    "X63": "=X62/X61",
    "Y63": "=Y62/Y61",
    "F65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&F$21), "#,##0")',
    "G65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&G$21), "#,##0")',
    "H65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&H$21), "#,##0")',
    "I65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&I$21), "#,##0")',
    "J65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&J$21), "#,##0")',
    "K65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&K$21), "#,##0")',
    "L65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&L$21), "#,##0")',
    "M65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&M$21), "#,##0")',
    "N65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&N$21), "#,##0")',
    "O65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&O$21), "#,##0")',
    "P65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&R$21), "#,##0")',
    "S65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&S$21), "#,##0")',
    "T65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&T$21), "#,##0")',
    "U65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&U$21), "#,##0")',
    "V65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&V$21), "#,##0")',
    "W65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&W$21), "#,##0")',
    "X65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y65": '=TEXT(COUNTIFS(Report!$B:$B,$C64,Report!$C:$C,$D64,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F66": "=F65/F64",
    "G66": "=G65/G64",
    "H66": "=H65/H64",
    "I66": "=I65/I64",
    "J66": "=J65/J64",
    "K66": "=K65/K64",
    "L66": "=L65/L64",
    "M66": "=M65/M64",
    "N66": "=N65/N64",
    "O66": "=O65/O64",
    "P66": "=P65/P64",
    "Q66": "=Q65/Q64",
    "R66": "=R65/R64",
    "S66": "=S65/S64",
    "T66": "=T65/T64",
    "U66": "=U65/U64",
    "V66": "=V65/V64",
    "W66": "=W65/W64",
    "X66": "=X65/X64",
    "Y66": "=Y65/Y64",
    "F68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&F$21), "#,##0")',
    "G68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&G$21), "#,##0")',
    "H68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&H$21), "#,##0")',
    "I68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&I$21), "#,##0")',
    "J68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&J$21), "#,##0")',
    "K68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&K$21), "#,##0")',
    "L68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&L$21), "#,##0")',
    "M68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&M$21), "#,##0")',
    "N68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&N$21), "#,##0")',
    "O68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&O$21), "#,##0")',
    "P68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&R$21), "#,##0")',
    "S68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&S$21), "#,##0")',
    "T68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&T$21), "#,##0")',
    "U68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&U$21), "#,##0")',
    "V68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&V$21), "#,##0")',
    "W68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&W$21), "#,##0")',
    "X68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y68": '=TEXT(COUNTIFS(Report!$B:$B,$C67,Report!$C:$C,$D67,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F69": "=F68/F67",
    "G69": "=G68/G67",
    "H69": "=H68/H67",
    "I69": "=I68/I67",
    "J69": "=J68/J67",
    "K69": "=K68/K67",
    "L69": "=L68/L67",
    "M69": "=M68/M67",
    "N69": "=N68/N67",
    "O69": "=O68/O67",
    "P69": "=P68/P67",
    "Q69": "=Q68/Q67",
    "R69": "=R68/R67",
    "S69": "=S68/S67",
    "T69": "=T68/T67",
    "U69": "=U68/U67",
    "V69": "=V68/V67",
    "W69": "=W68/W67",
    "X69": "=X68/X67",
    "Y69": "=Y68/Y67",
    "F71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&F$21), "#,##0")',
    "G71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&G$21), "#,##0")',
    "H71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&H$21), "#,##0")',
    "I71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&I$21), "#,##0")',
    "J71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&J$21), "#,##0")',
    "K71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&K$21), "#,##0")',
    "L71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&L$21), "#,##0")',
    "M71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&M$21), "#,##0")',
    "N71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&N$21), "#,##0")',
    "O71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&O$21), "#,##0")',
    "P71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&P$21), "#,##0")',
    "Q71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&Q$21), "#,##0")',
    "R71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&R$21), "#,##0")',
    "S71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&S$21), "#,##0")',
    "T71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&T$21), "#,##0")',
    "U71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&U$21), "#,##0")',
    "V71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&V$21), "#,##0")',
    "W71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&W$21), "#,##0")',
    "X71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&X$21), "#,##0")',
    "Y71": '=TEXT(COUNTIFS(Report!$B:$B,$C70,Report!$C:$C,$D70,Report!$J:$J,$E70,Report!$P:$P,"<="&Y$21), "#,##0")',
    "F72": "=F71/F70",
    "G72": "=G71/G70",
    "H72": "=H71/H70",
    "I72": "=I71/I70",
    "J72": "=J71/J70",
    "K72": "=K71/K70",
    "L72": "=L71/L70",
    "M72": "=M71/M70",
    "N72": "=N71/N70",
    "O72": "=O71/O70",
    "P72": "=P71/P70",
    "Q72": "=Q71/Q70",
    "R72": "=R71/R70",
    "S72": "=S71/S70",
    "T72": "=T71/T70",
    "U72": "=U71/U70",
    "V72": "=V71/V70",
    "W72": "=W71/W70",
    "X72": "=X71/X70",
    "Y72": "=Y71/Y70",
    "F2": '=TEXT(F22, "#,##0")',
    "F3": '=TEXT(F25, "#,##0")',
    "F4": '=TEXT(F28, "#,##0")',
    "F5": '=TEXT(F31, "#,##0")',
    "F6": '=TEXT(F34, "#,##0")',
    "F7": '=TEXT(F37, "#,##0")',
    "F8": '=TEXT(F40, "#,##0")',
    "F9": '=TEXT(F43, "#,##0")',
    "F10": '=TEXT(F46, "#,##0")',
    "F11": '=TEXT(F49, "#,##0")',
    "F12": '=TEXT(F52, "#,##0")',
    "F13": '=TEXT(F55, "#,##0")',
    "F14": '=TEXT(F58, "#,##0")',
    "F15": '=TEXT(F61, "#,##0")',
    "F16": '=TEXT(F64, "#,##0")',
    "F17": '=TEXT(F67, "#,##0")',
    "F18": '=TEXT(F70, "#,##0")',
    "G2": "=F24",
    "G3": "=F27",
    "G4": "=F30",
    "G5": "=F33",
    "G6": "=F36",
    "G7": "=F39",
    "G8": "=F42",
    "G9": "=F45",
    "G10": "=F48",
    "G11": "=F51",
    "G12": "=F54",
    "G13": "=F57",
    "G14": "=F60",
    "G15": "=F63",
    "G16": "=F66",
    "G17": "=F69",
    "G18": "=F72",
    "AA2": "=F21",
    "AA3": "=G21",
    "AA4": "=H21",
    "AA5": "=I21",
    "AA6": "=J21",
    "AA7": "=K21",
    "AA8": "=L21",
    "AA9": "=M21",
    "AB2": "=F24",
    "AB3": "=G24",
    "AB4": "=H24",
    "AB5": "=I24",
    "AB6": "=J24",
    "AB7": "=K24",
    "AB8": "=L24",
    "AB9": "=M24",
    "AC2": "=F39",
    "AC3": "=G39",
    "AC4": "=H39",
    "AC5": "=I39",
    "AC6": "=J39",
    "AC7": "=K39",
    "AC8": "=L39",
    "AC9": "=M39",
    "AD2": "=F54",
    "AD3": "=G54",
    "AD4": "=H54",
    "AD5": "=I54",
    "AD6": "=J54",
    "AD7": "=K54",
    "AD8": "=L54",
    "AD9": "=M54",
    "AE2": "=F69",
    "AE3": "=G69",
    "AE4": "=H69",
    "AE5": "=I69",
    "AE6": "=J69",
    "AE7": "=K69",
    "AE8": "=L69",
    "AE9": "=M69",
    "AF2": "=F72",
    "AF3": "=G72",
    "AF4": "=H72",
    "AF5": "=I72",
    "AF6": "=J72",
    "AF7": "=K72",
    "AF8": "=L72",
    "AF9": "=M72",
}
cell_format = {
    "B2:B18": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "B1:B1": {
        "border": thin_border,
    },
    "B20:Y20": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F21:Y21": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "number_format": 'mm-dd-yy',
        "align_right": True,
        "border": thin_border,
    },
    "B21:B21": {
        "border": thin_border,
    },
    "F1:G1": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "wrap_text": True,
        "border": thin_border,
    },
    "AB1:AF1": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "wrap_text": True,
        "border": thin_border,
    },
    "AA1:AA1": {
        "border": thin_border,
    },
    "B22:Y22": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "B23:B24": {
        "border": thin_border,
    },
    "F22:Y22": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F23:Y24": {
        "align_right": True,
        "border": thin_border,
    },
    "B25:Y25": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "B26:B27": {
        "border": thin_border,
    },
    "F25:Y25": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F26:Y27": {
        "align_right": True,
        "border": thin_border,
    },
    "B28:Y28": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "B29:B30": {
        "border": thin_border,
    },
    "F28:Y28": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F29:Y30": {
        "align_right": True,
        "border": thin_border,
    },
    "B31:Y31": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F31:Y31": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "B32:B33": {
        "border": thin_border,
    },
    "F32:Y33": {
        "align_right": True,
        "border": thin_border,
    },
    "B34:Y34": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F34:Y34": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "B35:B36": {
        "border": thin_border,
    },
    "F35:Y36": {
        "align_right": True,
        "border": thin_border,
    },
    "B37:Y37": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F37:Y37": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "B38:B39": {
        "border": thin_border,
    },
    "F38:Y39": {
        "align_right": True,
        "border": thin_border,
    },
    "B40:Y40": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F40:Y40": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "B41:B42": {
        "border": thin_border,
    },
    "F41:Y42": {
        "align_right": True,
        "border": thin_border,
    },
    "B43:Y43": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F43:Y43": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "B44:B45": {
        "border": thin_border,
    },
    "F44:Y45": {
        "align_right": True,
        "border": thin_border,
    },
    "B47:B48": {
        "border": thin_border,
    },
    "B46:Y46": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border
    },
    "F46:Y46": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F47:Y48": {
        "align_right": True,
        "border": thin_border,
    },
    "B50:B51": {
        "border": thin_border,
    },
    "B49:Y49": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F49:Y49": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F50:Y51": {
        "align_right": True,
        "border": thin_border,
    },
    "B53:B54": {
        "border": thin_border,
    },
    "B52:Y52": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F52:Y52": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F53:Y54": {
        "align_right": True,
        "border": thin_border,
    },
    "B56:B57": {
        "border": thin_border,
    },
    "B55:Y55": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F55:Y55": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F56:Y57": {
        "align_right": True,
        "border": thin_border,
    },
    "B59:B60": {
        "border": thin_border,
    },
    "B58:Y58": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F58:Y58": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F59:Y60": {
        "align_right": True,
        "border": thin_border,
    },
    "B62:B63": {
        "border": thin_border,
    },
    "B61:Y61": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F61:Y61": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F62:Y63": {
        "align_right": True,
        "border": thin_border,
    },
    "B65:B66": {
        "border": thin_border,
    },
    "B64:Y64": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F64:Y64": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F65:Y66": {
        "align_right": True,
        "border": thin_border,
    },
    "B68:B69": {
        "border": thin_border,
    },
    "B67:Y67": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F67:Y67": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F68:Y69": {
        "align_right": True,
        "border": thin_border,
    },
    "B71:B72": {
        "border": thin_border,
    },
    "B70:Y70": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "border": thin_border,
    },
    "F70:Y70": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "align_right": True,
        "border": thin_border,
    },
    "F71:Y72": {
        "align_right": True,
        "border": thin_border,
    },
    "AA2:AA9": {
        "font": standart_bold_font,
        "fill": standart_pattern_fill,
        "number_format": 'mm-dd-yy',
        "border": thin_border,
    },
    "AB2:AF9": {
        "align_right": True,
        "border": thin_border,
    },
}

def format_cells_percentage_hw_eol(work_sheet):
    # Apply percentage format to cells G2:G18
    for row in work_sheet.iter_rows(min_row=2, max_row=18, min_col=7, max_col=12):
        for cell in row:
            cell.number_format = '0.0%'
            
    # Apply percentage format to cells AB2:AF9
    for row in work_sheet.iter_rows(min_row=2, max_row=9, min_col=28, max_col=32):
        for cell in row:
            cell.number_format = '0.0%'

    # Apply percentage format to rows 24 to 72 in columns F to Y (column indexes 6 to 25)
    # Formatting every second row starting from row 24
    for row in work_sheet.iter_rows(min_row=24, max_row=72, min_col=6, max_col=25):
        if row[
            0].row % 3 == 0:  # Ensures formatting for even rows starting from 24
            for cell in row:
                cell.number_format = '0.0%'

def create_npl_hw_eol_timeline(wb: Workbook):
    ensure_tabs_exist(
        wb,
        (
            "NPL - HW EOL Timeline",
        )
    )
    ws = wb["NPL - HW EOL Timeline"]
    input_dates(ws, "F21", "Y21")
    input_values(
        ws,
        cell_values,
        cell_formulas,
    )
    calculate_values(
        ws,
        calculation_mapping_npl_hw_eol_timeline
    )

    ws.add_chart(
        create_bar_chart(
            data_categories=Reference(
                ws,
                min_col=2,
                min_row=2,
                max_col=2,
                max_row=18
            ),
            data_values=Reference(
                ws,
                min_col=7,
                min_row=1,
                max_col=7,
                max_row=18
            ),
            title="Hardware Chassis LDoS",
        ),
        "I2",
    )
    ws.add_chart(
        create_bar_chart(
            data_categories=Reference(
                ws,
                min_col=27,
                min_row=2,
                max_col=27,
                max_row=9
            ),
            data_values=Reference(
                ws,
                min_col=28,
                min_row=1,
                max_col=28,
                max_row=9
            ),
            title="Hardware Chassis LDoS (timeline snapshorts)",
        ),
        "AA11",
    )
    ws.add_chart(
        create_bar_chart(
            data_categories=Reference(
                ws,
                min_col=27,
                min_row=2,
                max_col=27,
                max_row=9
            ),
            data_values=Reference(
                ws,
                min_col=29,
                min_row=1,
                max_col=29,
                max_row=9
            ),
            title="Corporate Chassis LDoS",
        ),
        "AJ11",
    )
    ws.add_chart(
        create_bar_chart(
            data_categories=Reference(
                ws,
                min_col=27,
                min_row=2,
                max_col=27,
                max_row=9
            ),
            data_values=Reference(
                ws,
                min_col=30,
                min_row=1,
                max_col=30,
                max_row=9
            ),
            title="Retail Chassis LDoS",
        ),
        "AA25",
    )
    ws.add_chart(
        create_bar_chart(
            data_categories=Reference(
                ws,
                min_col=27,
                min_row=2,
                max_col=27,
                max_row=9
            ),
            data_values=Reference(
                ws,
                min_col=31,
                min_row=1,
                max_col=31,
                max_row=9
            ),
            title="Wireless Chassis LDoS (Including APs)",
        ),
        "AJ25",
    )
    ws.add_chart(
        create_bar_chart(
            data_categories=Reference(
                ws,
                min_col=27,
                min_row=2,
                max_col=27,
                max_row=9
            ),
            data_values=Reference(
                ws,
                min_col=32,
                min_row=1,
                max_col=32,
                max_row=9
            ),
            title="Wireless Chassis LDoS (Excluding APs)",
        ),
        "AE39",
    )
    
    format_cells(
        ws,
        cell_format,
    )
    format_cells_percentage_hw_eol(wb['NPL - HW EOL Timeline'])
    column_sizing(ws)
    hide_columns(ws, [3, 4, 5])

    